# プルリクエストガイドライン

## 📏 プルリクエストのサイズについて

**推奨サイズ**: 500行以下の変更

### なぜ小さなPRが重要なのか？

1. **レビューの質向上**: 小さなPRは詳細なレビューが可能で、バグの発見率が向上します
2. **迅速なフィードバック**: レビューアが短時間で確認でき、開発サイクルが高速化されます
3. **リスクの軽減**: 問題が発生した場合の影響範囲を最小限に抑えられます
4. **理解しやすさ**: 変更内容の意図や影響を把握しやすくなります

### 大きなPRを避けるための戦略

#### ✅ 推奨アプローチ

- **機能単位での分割**: 大きな機能を小さな独立した機能に分割する
- **段階的実装**: MVP（最小実行可能製品）から始めて段階的に機能を追加
- **リファクタリングの分離**: コードの整理と新機能の追加を別々のPRに分ける
- **テストの分離**: テストコードの追加を機能実装とは別のPRで行う

#### 🔄 大きなPRの分割例

**❌ 悪い例 (1000行の変更)**
```
feat: ユーザー管理機能の実装
- ユーザー登録API
- ユーザー編集API  
- ユーザー削除API
- フロントエンドUI
- バリデーション
- テストコード
```

**✅ 良い例 (複数のPRに分割)**
```
1. feat: ユーザーモデルとデータベーススキーマの追加 (150行)
2. feat: ユーザー登録APIの実装 (180行)
3. feat: ユーザー編集・削除APIの実装 (200行)
4. feat: ユーザー管理画面UIの実装 (250行)
5. test: ユーザー管理機能のE2Eテスト追加 (220行)
```

## 🚨 500行を超える場合の対処法

### 1. 分割を検討する
- 独立した機能単位に分けられないか確認
- コミット履歴を見て自然な分割点を探す
- 依存関係を整理して順序立てて実装

### 2. 分割が困難な場合
以下の理由で分割が困難な場合は、PRの説明により詳細な情報を含めてください：

- **自動生成コード**: プリズマスキーマやAPIクライアントの生成
- **大規模リファクタリング**: アーキテクチャの変更など
- **データマイグレーション**: データベーススキーマの大幅な変更
- **外部ライブラリの更新**: 破壊的変更への対応

### 3. 詳細な説明を提供
大きなPRの場合、以下の情報を必ず含めてください：

- **変更の必要性**: なぜこのサイズでの変更が必要なのか
- **分割検討結果**: どのような分割を検討し、なぜ分割できないのか
- **影響範囲**: どの機能・コンポーネントに影響するのか
- **テスト戦略**: どのようにテストを行ったか
- **レビューポイント**: レビューアが重点的に確認すべき箇所

## 📋 チェックリスト

大きなPRを作成する前に、以下を確認してください：

- [ ] 機能単位での分割を検討した
- [ ] 段階的な実装アプローチを検討した
- [ ] PRの説明に分割困難な理由を記載した
- [ ] 影響範囲とリスクを明確にした
- [ ] 十分なテストを実施した
- [ ] レビューポイントを明確にした

## 🤝 レビューアの皆様へ

大きなPRをレビューする際は：

1. **全体像の理解**: まず変更の全体像と目的を把握
2. **重要度の優先**: セキュリティやパフォーマンスに関わる変更を優先
3. **分割提案**: 今後同様の変更で分割可能な点があれば提案
4. **建設的なフィードバック**: 改善点は具体的で実行可能な形で提案

## 📚 参考資料

- [Conventional Commits](https://www.conventionalcommits.org/ja/v1.0.0/)
- [CONTRIBUTING.md](./CONTRIBUTING.md)
- [Code Review Best Practices](https://github.com/google/eng-practices/blob/master/review/README.md)